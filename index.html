<!DOCTYPE html>
<html>
<head>
  <link href="css/styles.css" rel="stylesheet"/>
  <meta http-equiv="Access-Control-Allow-Origin" content="https://neubauten-software.github.io/">
  <title>Neubauten Software</title>
</head>
<body>
  <div class="toolbar">&#9776;</div>
  <div class="content" id="content">
    <button class="lenta-update" onclick="loadFeed();">Обновить</button>
    <div class="card-view">
      <h1>Обновление до версии v0.1</h1>
      <p>
        <li>Добавлено: простейший пользовательский интерфейс</li>
        <li>Функционал: счётчик кликов по кнопке</li><br/>
        Документ прилагается<br/>
        <a href="Counter.crx">Counter.crx</a>
      </p>
      <font color="#949494">21.09.2017.17:30</font>
    </div>
    <div class="card-view">
      <h1>Обновление расширения</h1>
      <p>
        <li>Добавлено: высплывающее окно,<br/>
          надпись "Hello, World!"
        </li>
        <a href="Hello_World.crx">Hello, World.crx</a>
      </p>
      <font color="#949494">21.09.2017.17:25</font>
    </div>
    <div class="card-view">
      <h1>Пустое расширение</h1>
      <p>
        Что из него выйдет?<br/>
        <a href="Unnamed.crx">Unnamed.crx</a>
      </p>
      <font color="#949494">21.09.2017.17:20</font>
    </div>
  </div>
  <script>
    var xhr = new XMLHttpRequest();
    
    function loadFeed() {
      xhr.onreadystatecange = function() {
        if (this.readyState == 4 && this.status == 200) {
          LoadPosts(this);
        }
      };

      xhr.open("GET", "channel/admin/posts.xml", true);
      xhr.setRequestHeader("Allow-Control-Allow-Origin", "https://neubauten-software.github.io/");
      xhr.send();
    }

    function LoadPosts(xml) {
      var card = "<div class=\"card-view\">";
      var doc = xml.responseXML;
      var post = doc.getElementsByTagName("post");

      for (var i = 0; i < post.length; i++) {
        card += "<img src\""
          + post[i].getElementsByTagName("cover")[0].childNodes[0].nodeValue
          + "\"/><br/><h1>" + post[i].getElementsByTagName("title")[0].childNodes[0].nodeValue
          + "</h1><p>" + post[i].getElementsByTagName("description")[0].childNodes[0].nodeValue
          + "</p><a href=\"" + post[i].getElementsByTagName("link")[0].childNodes[0].getAttribute("to")
          + "\">" + post[i].getElementsByTagName("link")[0].childNodes[0].getAttribute("title") + "</a>";
      }

      card += "</div>";

      console.log(card);
    }
  </script>
</body>
</html>
